# Cluster Design

![CATS Architecture](/img/architecture.png)


## System Components

This table outlines all of the system components utilized in the CATS platform. 


| Component                                            | Description                                                                                                                               | Link to Documentation on component                                               |
|-----------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------|
| Elastic Kubernetes Service (EKS)                    | Managed Kubernetes service offered by AWS that simplifies the deployment, management, and scaling of containerized applications using Kubernetes.               | [Link to AWS EKS Docs](https://docs.aws.amazon.com/eks/latest/userguide/getting-started.html)|
| EC2 and Fargate Container                           | Amazon Elastic Kubernetes Service (EKS) offers two compute options for managing containerized applications in Kubernetes clusters: EKS EC2-based worker nodes and AWS Fargate. With EC2-based nodes, you provision and manage Amazon EC2 instances for your Kubernetes cluster, gaining flexibility and control but requiring more operational overhead. On the other hand, AWS Fargate offers serverless container execution, abstracting away infrastructure management and providing granular billing. You create Fargate profiles to specify workloads that should run on Fargate. Utilizing either option involves creating an EKS cluster, defining node groups or Fargate profiles, deploying workloads, configuring service discovery and load balancing, and implementing monitoring and scaling solutions to meet specific application needs.                            | [Link to AWS EC2 Docs](https://docs.aws.amazon.com/ec2/) / [Link to AWS Fargate Docs](https://docs.aws.amazon.com/eks/latest/userguide/fargate.html)|
| Flux                                                | Flux is a delivery solution that allows the automatic deployment of application images via tags. This component allows application teams the ability to make changes to their application’s source code and then automatically see those changes get replicated in production after they publish the new application image to their main branch in GitHub.                            | [Link to Flux Docs](/guide/Flux) / Source Code TBD|
| GitHub Repository                                   | The GitHub repository is the location that we house all the source code for the CATS Platform. There are main, QA, and DEV branches that correspond to three different environments for development. All applications are deployed in the production environment and are isolated by namespaces to ensure there is no interference between applications.                            | [Link to Github Repo List](/guide/GitHubRepos)|
| GitHub Actions                                      | GitHub actions are used for the deployment of the CDK stack. Changes are validated and deployed by GitHub actions and the AWS CloudFormation service.                            | [Link to GitHub Actions Docs](https://docs.github.com/en/actions)|
| Bouncer                                             | Bouncer is an authorization service that uses Microsoft Graph & Kubernetes to provide easy authorization for microservice applications.                            | [Link to Bouncer Docs](/guide/Bouncer)|
| Application Load Balancer                           | An AWS Application Load Balancer (ALB) is a sophisticated traffic distribution and routing service designed for cloud-based applications. It operates at the application layer, intelligently directing incoming HTTP/HTTPS traffic to multiple backend instances or services based on factors like URL paths, hostnames, and headers.                            | Link TBD|
| Artifactory                                         | JFrog Artifactory is an artifact repository manager used in software development and DevOps workflows. It serves as a centralized hub for storing and managing binary artifacts, including libraries, packages, and dependencies.                            | [Link to Artifactory Docs](https://jfrog.com/help/r/jfrog-artifactory-documentation)|
| Azure Active Directory                              | Active Directory is used in conjunction with the Bouncer Service to authentic Users.                            | [Link Lilly Authentication Services Page](https://lilly.service-now.com/now/nav/ui/classic/params/target/kb_view.do%3Fsysparm_article%3DKB2018254)|
| Amazon Elastic Container Registry (ECR)             | AWS Elastic Container Registry (ECR) is a fully managed container registry service provided by Amazon Web Services (AWS). It is designed to store, manage, and deploy Docker container images, making it a crucial component in containerized application deployment. Since CATS is a Kubernetes based platform, this component is crucial for implementing a container-based application hosting system.                            | [Link to AWS ECR docs](https://docs.aws.amazon.com/ecr/)|
| Grafana                                             | Grafana is an open-source service used for monitoring and observability, in our case in the context of deployed application and CATS platform infrastructure. It provides data visualization and analytics through customizable dashboards, enabling our software developers to monitor and analyze metrics from various data sources in real-time.                            | [Link to Metrics Dashboard powered by Grafana](/guide/Grafana) / [Link to Grafana Docs](https://grafana.com/docs/grafana/latest/)|
| Crossplane                                          | Crossplane is an open-source Kubernetes extension that we provide our users as a service. This service empowers our users to manage cloud infrastructure and services declaratively from within their Kubernetes resource definitions. It allows for the provisioning and orchestration of resources like databases, storage, and networking as if they were Kubernetes objects, streamlining the deployment and management of cloud-native applications.                            | [Link to CATS Crossplane Section](/guide/Crossplane#crossplane--auto-resource-deployer) / [Link to Crossplane Docs](https://docs.crossplane.io/v1.15/)|
| AWS Aurora and Relational Database Service (RDS)    | AWS Aurora/RDS is a fully managed relational database service offered by Amazon Web Services (AWS). When a user employs Crossplane, Crossplane interfaces with AWS Aurora/RDS to create a database by using Crossplane's custom resource definitions (CRDs).                            | [Link to AWS Aurora and RDS Docs](https://docs.aws.amazon.com/rds/)|
| AWS Secrets Manager                                 | AWS Secrets Manager is an AWS-managed service for securely storing and rotating sensitive data like credentials and API keys used by applications. CATS integrates with AWS Secrets Manager to manage secrets more securely, using IAM roles to access and control access to these secrets. This integration simplifies secrets management within Kubernetes while enhancing security and access control.                            | [Link to AWS Secrets Manager Docs](https://docs.aws.amazon.com/secretsmanager/)|
| External Secrets Manager                            | An open-source service that synchronizes secrets from AWS into Kubernetes secret resources.                            | [Link to K8s External Secrets Manager Repo](https://github.com/external-secrets/kubernetes-external-secrets)|
| Amazon Route 53                                     | AWS Route 53 is used to manage the DNS records for CATS, allowing us to assign human-readable domain names to our cluster-based resources. For example, you can map a domain name like "lilly.application.com" to the IP addresses of our Kubernetes services.                            | [Link to AWS Route53 Docs](https://docs.aws.amazon.com/route53/)|
| Amazon Web Application Firewall (WAF)               | Amazon’s Web Application Firewall is an enterprise level managed web application firewall service provided by Amazon Web Services (AWS).                            | [Link to AWS WAF docs](https://docs.aws.amazon.com/waf/)|
| S3 Cloud Browser                                    | Interact with AWS S3 buckets effortlessly using CloudBrowser, a graphical interface that streamlines storage management.                            | [Link to S3 Cloudbrowser Section](/guide/CloudBrowser)|
| PGadmin                                             | PGadmin is an open-source administration and management tool for PostgreSQL, which is a powerful open-source relational database management system (RDBMS). PGadmin is designed to provide a user-friendly graphical interface for database administrators, developers, and other users to interact with PostgreSQL databases.                            | [Link to PGadmin Section](/guide/PGAdmin) / [Link to PGadmin Docs](https://www.pgadmin.org/docs/)|
| Kubecost                                            | Kubecost is an open-source cost-monitoring tool that provides developers with real-time cost breakdown of their Kubernetes resources running on the CATS platform. Costs are broken down by in-cluster resource usage like CPU, RAM, and Persistent Volume, as well as Kubernetes objects like namespaces, nodes, and pods.                            | [Link to Kubecost Section](/guide/Kubecost) / [Kubecost Docs](https://docs.kubecost.com/)|
| External DNS                                        | Keeps DNS records synchronized with your external entry points                            | [Link to External DNS K8s Docs](https://github.com/kubernetes-sigs/external-dns/blob/master/docs/faq.md)|
| Gemini Controller                                  | TBD - Backup Snapshots for EBS volumes. Backup snapshots for Amazon Elastic Block Store (EBS) volumes are point-in-time copies of our data in AWS. They are an essential part of any data backup strategy and are used to restore data in the case of a failure, error, or data loss. Snapshots capture a specific state of a volume and can be used to initialize new volumes with the captured data. They are incremental, so only the blocks that have changed since the last snapshot are saved, which minimizes the storage costs.                            | [Link to Gemini Docs](https://docs.countersoft.com/)|
| Healthcheck                                         | Custom built solution by the CATS Team. The purpose of this service is to monitor the health of the CATS Platform. When the Lambda successfully sends a request to the API endpoint, the service will return a response with a status code of 200. However, if the request fails, notifications will be automatically sent to the CATS support team to alert them of the issue.                            | [Link to Healthcheck App Repo](https://github.com/EliLillyCo/LRL_light_k8s_infra_healthcheck)|
| Kubernetes Dashboard                                | The Kubernetes Dashboard is a web-based graphical user interface (GUI) that provides our developers and administrators with a convenient way to interact with and manage the Kubernetes cluster resources. It offers a visual representation of various resources and components within the cluster, making it easier to monitor, troubleshoot, and perform administrative tasks.                            | [Link to CATS K8s Dashboard Section](/guide/KubernetesDashboard) / [Link to Kubernetes Dashboard docs](https://kubernetes.io/docs/tasks/access-application-cluster/web-ui-dashboard/)|
| K8s Manager                                         | TBD                            | Link TBD|
| Keda                                                | TBD - Autoscaler based on message queues.                            | Link TBD|
| Grafana                | Grafana is a powerful open-source analytics and monitoring platform that serves as the main visualization and query tool for Prometheus, Loki, and Jaeger. It allows users to create custom dashboards to visualize metrics, logs, and traces in an intuitive and visually appealing manner. With a wide range of visualization options, including graphs, charts, and tables, Grafana helps users track performance trends, identify anomalies, and gain actionable insights into their applications and infrastructure. Additionally, Grafana supports alerting functionalities, enabling teams to set up notifications based on specific conditions to ensure timely responses to potential issues.                         | [Link CATS Metrics Dashboard Section](/guide/Grafana) / [Link to Grafana Docs](https://grafana.com/docs/grafana/latest/) |
| Prometheus Metrics                | Prometheus is an open-source monitoring and alerting toolkit designed for collecting, storing, querying, and visualizing metrics from diverse software systems. Operating on a pull-based model, Prometheus regularly scrapes metrics data from monitored services and stores it in a time-series database, where it can be efficiently queried and analyzed.                         | [Link CATS Metrics Dashboard Section](/guide/Grafana) / [Link to Grafana Docs](https://grafana.com/docs/grafana/latest/) / [Link to Prometheus Docs](https://prometheus.io/docs/introduction/overview/)|
| Loki Logs                                     | Loki is an open-source log aggregation system designed to efficiently collect, store, and query logs from various applications. Unlike traditional log management systems, Loki indexes only the metadata of the logs, making it highly efficient and cost-effective. It integrates seamlessly with Grafana, allowing users to visualize and analyze log data alongside metrics and traces, providing a comprehensive observability solution. Loki supports querying historical log streams, enabling users to troubleshoot issues and gain insights into application behavior over time.           | [Link CATS Logs Dashboard Section](/guide/Grafana) / [Link to Loki Docs](https://grafana.com/docs/loki/latest/)|
| Jaeger Tracing                  | Jaeger is an open-source, end-to-end distributed tracing tool used for monitoring and troubleshooting microservices-based distributed systems. It helps in tracking requests as they travel through various services, providing visibility into the system's performance and aiding in identifying bottlenecks, latencies, or errors. Jaeger supports features like distributed context propagation, performance monitoring, root cause analysis, service dependency analysis, and error detection.                         | [Link CATS Jaeger Tracing Section](/guide/Jaeger) / [Link to Jaeger Docs](https://www.jaegertracing.io/docs/1.18/) |
| Simple Mail Transfer Protocol (SMTP) Service        | The Simple Mail Transfer Protocol (SMTP) is a fundamental internet protocol used for the transfer of electronic mail (email) messages between computers or email servers. SMTP is part of the application layer of the TCP/IP protocol suite and is responsible for routing and delivering email messages from the sender to the recipient's email server.                            | [Link to AWS SES docs](https://docs.aws.amazon.com/ses/)|
| Elastic Block Storage (EBS) Controller              | Amazon Elastic Block Storage (EBS) is an AWS service offering block-level storage solutions designed for Amazon Elastic Compute Cloud (EC2) instances. These EBS volumes serve as attachable storage devices, offering both durability and scalability. They are versatile, accommodating various use cases, such as data storage, database management, and application data storage within the AWS cloud infrastructure.                            | [Link to AWS EBS docs](https://docs.aws.amazon.com/eks/latest/userguide/ebs-csi.html)|
| FSXx Controller                                     | Cloud-based managed file storage service offering Windows and Lustre options. Amazon FSx is a cloud-based managed file storage service offering two key options: Amazon FSx for Windows File Server, tailored for Windows workloads and accessible from both Windows and Linux instances, and Amazon FSx for Lustre, designed for high-performance computing tasks. The former delivers fully managed Windows file shares, built on Microsoft Windows File Server, suitable for critical Windows applications, while the latter offers a high-performance, fully managed file system optimized for compute-intensive workloads.                            | [Link to FSX Docs](https://docs.aws.amazon.com/fsx/)|
| Elastic File System (EFS) Controller                | Elastic File System (EFS), a managed file storage service from AWS, provides scalable network-attached storage (NAS) that can be effortlessly shared across multiple EC2 instances. EFS is versatile, catering to a variety of applications, including content repositories, data sharing, and application data storage. What sets EFS apart is its ability to automatically scale its storage capacity as data grows, offering a convenient solution for applications with fluctuating storage requirements, ensuring both flexibility and cost-effectiveness.                            | [Link to AWS EFS Docs](https://docs.aws.amazon.com/efs/)|
| Wave                                                | Wave watches Deployments within a Kubernetes cluster and ensures that each Deployment's Pods always have up to date configuration.                            | [Link to Public Wave Repo](https://github.com/wave-k8s/wave)|
| Application Runner Gateway                          | AWS App Runner is an AWS service that provides a fast, simple, and cost-effective way to deploy from source code or a container image directly to a scalable and secure web application in the AWS Cloud. You don't need to learn new technologies, decide which compute service to use, or know how to provision and configure AWS resources.                            | [Link to AWS AppRunner Docs](https://docs.aws.amazon.com/apprunner/latest/dg/what-is-apprunner.html)|

